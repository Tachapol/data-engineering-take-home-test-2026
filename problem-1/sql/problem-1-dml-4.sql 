-- Q4 Find the date with the highest number of new customers acquired

WITH first_orders AS (
    SELECT user_id, MIN(DATE(order_timestamp)) as first_date
    FROM orders
    WHERE status = 'COMPLETE'
    GROUP BY user_id
)
SELECT 
    first_date, 
    COUNT(*) as new_customer_count
FROM first_orders
GROUP BY first_date
ORDER BY new_customer_count DESC
LIMIT 10;